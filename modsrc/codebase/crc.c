#include "unifw.h"
#include "base/crc.h"

/*
 *  CCITT      CRC16：多项式是X16+X12+X5+1，对应的数字是0x11021
 *  IEEE 802.3 CRC32：多项式是X32+X26+X23+X22+X16+X12+X11+X10+X8+X7+X5+X4+X2+X1+1，对应数字是0x104C11DB7
 *	Castagnoli_POLY_CRC32C: 多项式是x32+x28+x27+x26+x25+x23+x22+x20+x19+x18+x14+x13+x11+x10+x9+x8+x6+1，对应数字0x1EDC6F41
 */
#define CCITT_POLY16           (0x1021)
#define IEEE8023_POLY32        (0x04C11DB7)
#define Castagnoli_POLY_CRC32C (0x1EDC6F41)

/*- CRC表 */
static const uint16_t CCITT_CRC16_TABLE[256]=
{
	/*- CCITT CRC16生成多项式采用0x1021 */
	0x0000,0x1021,0x2042,0x3063,0x4084,0x50a5,0x60c6,0x70e7,0x8108,0x9129,0xa14a,0xb16b,0xc18c,0xd1ad,0xe1ce,0xf1ef,
	0x1231,0x0210,0x3273,0x2252,0x52b5,0x4294,0x72f7,0x62d6,0x9339,0x8318,0xb37b,0xa35a,0xd3bd,0xc39c,0xf3ff,0xe3de,
	0x2462,0x3443,0x0420,0x1401,0x64e6,0x74c7,0x44a4,0x5485,0xa56a,0xb54b,0x8528,0x9509,0xe5ee,0xf5cf,0xc5ac,0xd58d,
	0x3653,0x2672,0x1611,0x0630,0x76d7,0x66f6,0x5695,0x46b4,0xb75b,0xa77a,0x9719,0x8738,0xf7df,0xe7fe,0xd79d,0xc7bc,
	0x48c4,0x58e5,0x6886,0x78a7,0x0840,0x1861,0x2802,0x3823,0xc9cc,0xd9ed,0xe98e,0xf9af,0x8948,0x9969,0xa90a,0xb92b,
	0x5af5,0x4ad4,0x7ab7,0x6a96,0x1a71,0x0a50,0x3a33,0x2a12,0xdbfd,0xcbdc,0xfbbf,0xeb9e,0x9b79,0x8b58,0xbb3b,0xab1a,
	0x6ca6,0x7c87,0x4ce4,0x5cc5,0x2c22,0x3c03,0x0c60,0x1c41,0xedae,0xfd8f,0xcdec,0xddcd,0xad2a,0xbd0b,0x8d68,0x9d49,
	0x7e97,0x6eb6,0x5ed5,0x4ef4,0x3e13,0x2e32,0x1e51,0x0e70,0xff9f,0xefbe,0xdfdd,0xcffc,0xbf1b,0xaf3a,0x9f59,0x8f78,
	0x9188,0x81a9,0xb1ca,0xa1eb,0xd10c,0xc12d,0xf14e,0xe16f,0x1080,0x00a1,0x30c2,0x20e3,0x5004,0x4025,0x7046,0x6067,
	0x83b9,0x9398,0xa3fb,0xb3da,0xc33d,0xd31c,0xe37f,0xf35e,0x02b1,0x1290,0x22f3,0x32d2,0x4235,0x5214,0x6277,0x7256,
	0xb5ea,0xa5cb,0x95a8,0x8589,0xf56e,0xe54f,0xd52c,0xc50d,0x34e2,0x24c3,0x14a0,0x0481,0x7466,0x6447,0x5424,0x4405,
	0xa7db,0xb7fa,0x8799,0x97b8,0xe75f,0xf77e,0xc71d,0xd73c,0x26d3,0x36f2,0x0691,0x16b0,0x6657,0x7676,0x4615,0x5634,
	0xd94c,0xc96d,0xf90e,0xe92f,0x99c8,0x89e9,0xb98a,0xa9ab,0x5844,0x4865,0x7806,0x6827,0x18c0,0x08e1,0x3882,0x28a3,
	0xcb7d,0xdb5c,0xeb3f,0xfb1e,0x8bf9,0x9bd8,0xabbb,0xbb9a,0x4a75,0x5a54,0x6a37,0x7a16,0x0af1,0x1ad0,0x2ab3,0x3a92,
	0xfd2e,0xed0f,0xdd6c,0xcd4d,0xbdaa,0xad8b,0x9de8,0x8dc9,0x7c26,0x6c07,0x5c64,0x4c45,0x3ca2,0x2c83,0x1ce0,0x0cc1,
	0xef1f,0xff3e,0xcf5d,0xdf7c,0xaf9b,0xbfba,0x8fd9,0x9ff8,0x6e17,0x7e36,0x4e55,0x5e74,0x2e93,0x3eb2,0x0ed1,0x1ef0
};

static const uint32_t IEEE8023_CRC32_TABLE[256]=
{
	/*- IEEE 802.3 对应数字是0xEDB88320(即0x04C11DB7的镜像) */
	0x00000000,0x77073096,0xee0e612c,0x990951ba,0x076dc419,0x706af48f,
	0xe963a535,0x9e6495a3,0x0edb8832,0x79dcb8a4,0xe0d5e91e,0x97d2d988,
	0x09b64c2b,0x7eb17cbd,0xe7b82d07,0x90bf1d91,0x1db71064,0x6ab020f2,
	0xf3b97148,0x84be41de,0x1adad47d,0x6ddde4eb,0xf4d4b551,0x83d385c7,
	0x136c9856,0x646ba8c0,0xfd62f97a,0x8a65c9ec,0x14015c4f,0x63066cd9,
	0xfa0f3d63,0x8d080df5,0x3b6e20c8,0x4c69105e,0xd56041e4,0xa2677172,
	0x3c03e4d1,0x4b04d447,0xd20d85fd,0xa50ab56b,0x35b5a8fa,0x42b2986c,
	0xdbbbc9d6,0xacbcf940,0x32d86ce3,0x45df5c75,0xdcd60dcf,0xabd13d59,
	0x26d930ac,0x51de003a,0xc8d75180,0xbfd06116,0x21b4f4b5,0x56b3c423,
	0xcfba9599,0xb8bda50f,0x2802b89e,0x5f058808,0xc60cd9b2,0xb10be924,
	0x2f6f7c87,0x58684c11,0xc1611dab,0xb6662d3d,0x76dc4190,0x01db7106,
	0x98d220bc,0xefd5102a,0x71b18589,0x06b6b51f,0x9fbfe4a5,0xe8b8d433,
	0x7807c9a2,0x0f00f934,0x9609a88e,0xe10e9818,0x7f6a0dbb,0x086d3d2d,
	0x91646c97,0xe6635c01,0x6b6b51f4,0x1c6c6162,0x856530d8,0xf262004e,
	0x6c0695ed,0x1b01a57b,0x8208f4c1,0xf50fc457,0x65b0d9c6,0x12b7e950,
	0x8bbeb8ea,0xfcb9887c,0x62dd1ddf,0x15da2d49,0x8cd37cf3,0xfbd44c65,
	0x4db26158,0x3ab551ce,0xa3bc0074,0xd4bb30e2,0x4adfa541,0x3dd895d7,
	0xa4d1c46d,0xd3d6f4fb,0x4369e96a,0x346ed9fc,0xad678846,0xda60b8d0,
	0x44042d73,0x33031de5,0xaa0a4c5f,0xdd0d7cc9,0x5005713c,0x270241aa,
	0xbe0b1010,0xc90c2086,0x5768b525,0x206f85b3,0xb966d409,0xce61e49f,
	0x5edef90e,0x29d9c998,0xb0d09822,0xc7d7a8b4,0x59b33d17,0x2eb40d81,
	0xb7bd5c3b,0xc0ba6cad,0xedb88320,0x9abfb3b6,0x03b6e20c,0x74b1d29a,
	0xead54739,0x9dd277af,0x04db2615,0x73dc1683,0xe3630b12,0x94643b84,
	0x0d6d6a3e,0x7a6a5aa8,0xe40ecf0b,0x9309ff9d,0x0a00ae27,0x7d079eb1,
	0xf00f9344,0x8708a3d2,0x1e01f268,0x6906c2fe,0xf762575d,0x806567cb,
	0x196c3671,0x6e6b06e7,0xfed41b76,0x89d32be0,0x10da7a5a,0x67dd4acc,
	0xf9b9df6f,0x8ebeeff9,0x17b7be43,0x60b08ed5,0xd6d6a3e8,0xa1d1937e,
	0x38d8c2c4,0x4fdff252,0xd1bb67f1,0xa6bc5767,0x3fb506dd,0x48b2364b,
	0xd80d2bda,0xaf0a1b4c,0x36034af6,0x41047a60,0xdf60efc3,0xa867df55,
	0x316e8eef,0x4669be79,0xcb61b38c,0xbc66831a,0x256fd2a0,0x5268e236,
	0xcc0c7795,0xbb0b4703,0x220216b9,0x5505262f,0xc5ba3bbe,0xb2bd0b28,
	0x2bb45a92,0x5cb36a04,0xc2d7ffa7,0xb5d0cf31,0x2cd99e8b,0x5bdeae1d,
	0x9b64c2b0,0xec63f226,0x756aa39c,0x026d930a,0x9c0906a9,0xeb0e363f,
	0x72076785,0x05005713,0x95bf4a82,0xe2b87a14,0x7bb12bae,0x0cb61b38,
	0x92d28e9b,0xe5d5be0d,0x7cdcefb7,0x0bdbdf21,0x86d3d2d4,0xf1d4e242,
	0x68ddb3f8,0x1fda836e,0x81be16cd,0xf6b9265b,0x6fb077e1,0x18b74777,
	0x88085ae6,0xff0f6a70,0x66063bca,0x11010b5c,0x8f659eff,0xf862ae69,
	0x616bffd3,0x166ccf45,0xa00ae278,0xd70dd2ee,0x4e048354,0x3903b3c2,
	0xa7672661,0xd06016f7,0x4969474d,0x3e6e77db,0xaed16a4a,0xd9d65adc,
	0x40df0b66,0x37d83bf0,0xa9bcae53,0xdebb9ec5,0x47b2cf7f,0x30b5ffe9,
	0xbdbdf21c,0xcabac28a,0x53b39330,0x24b4a3a6,0xbad03605,0xcdd70693,
	0x54de5729,0x23d967bf,0xb3667a2e,0xc4614ab8,0x5d681b02,0x2a6f2b94,
	0xb40bbe37,0xc30c8ea1,0x5a05df1b,0x2d02ef8d
};

const uint32_t Castagnoli_X_CRC32_TABLE[256] =
{
    /*- Castagnoli CRC32 生成多项式采用0x1EDC6F41 */
	0x00000000,0x1edc6f41,0x3db8de82,0x2364b1c3,0x7b71bd04,0x65add245,
	0x46c96386,0x58150cc7,0xf6e37a08,0xe83f1549,0xcb5ba48a,0xd587cbcb,
	0x8d92c70c,0x934ea84d,0xb02a198e,0xaef676cf,0xf31a9b51,0xedc6f410,
	0xcea245d3,0xd07e2a92,0x886b2655,0x96b74914,0xb5d3f8d7,0xab0f9796,
	0x05f9e159,0x1b258e18,0x38413fdb,0x269d509a,0x7e885c5d,0x6054331c,
	0x433082df,0x5deced9e,0xf8e959e3,0xe63536a2,0xc5518761,0xdb8de820,
	0x8398e4e7,0x9d448ba6,0xbe203a65,0xa0fc5524,0x0e0a23eb,0x10d64caa,
	0x33b2fd69,0x2d6e9228,0x757b9eef,0x6ba7f1ae,0x48c3406d,0x561f2f2c,
	0x0bf3c2b2,0x152fadf3,0x364b1c30,0x28977371,0x70827fb6,0x6e5e10f7,
	0x4d3aa134,0x53e6ce75,0xfd10b8ba,0xe3ccd7fb,0xc0a86638,0xde740979,
	0x866105be,0x98bd6aff,0xbbd9db3c,0xa505b47d,0xef0edc87,0xf1d2b3c6,
	0xd2b60205,0xcc6a6d44,0x947f6183,0x8aa30ec2,0xa9c7bf01,0xb71bd040,
	0x19eda68f,0x0731c9ce,0x2455780d,0x3a89174c,0x629c1b8b,0x7c4074ca,
	0x5f24c509,0x41f8aa48,0x1c1447d6,0x02c82897,0x21ac9954,0x3f70f615,
	0x6765fad2,0x79b99593,0x5add2450,0x44014b11,0xeaf73dde,0xf42b529f,
	0xd74fe35c,0xc9938c1d,0x918680da,0x8f5aef9b,0xac3e5e58,0xb2e23119,
	0x17e78564,0x093bea25,0x2a5f5be6,0x348334a7,0x6c963860,0x724a5721,
	0x512ee6e2,0x4ff289a3,0xe104ff6c,0xffd8902d,0xdcbc21ee,0xc2604eaf,
	0x9a754268,0x84a92d29,0xa7cd9cea,0xb911f3ab,0xe4fd1e35,0xfa217174,
	0xd945c0b7,0xc799aff6,0x9f8ca331,0x8150cc70,0xa2347db3,0xbce812f2,
	0x121e643d,0x0cc20b7c,0x2fa6babf,0x317ad5fe,0x696fd939,0x77b3b678,
	0x54d707bb,0x4a0b68fa,0xc0c1d64f,0xde1db90e,0xfd7908cd,0xe3a5678c,
	0xbbb06b4b,0xa56c040a,0x8608b5c9,0x98d4da88,0x3622ac47,0x28fec306,
	0x0b9a72c5,0x15461d84,0x4d531143,0x538f7e02,0x70ebcfc1,0x6e37a080,
	0x33db4d1e,0x2d07225f,0x0e63939c,0x10bffcdd,0x48aaf01a,0x56769f5b,
	0x75122e98,0x6bce41d9,0xc5383716,0xdbe45857,0xf880e994,0xe65c86d5,
	0xbe498a12,0xa095e553,0x83f15490,0x9d2d3bd1,0x38288fac,0x26f4e0ed,
	0x0590512e,0x1b4c3e6f,0x435932a8,0x5d855de9,0x7ee1ec2a,0x603d836b,
	0xcecbf5a4,0xd0179ae5,0xf3732b26,0xedaf4467,0xb5ba48a0,0xab6627e1,
	0x88029622,0x96def963,0xcb3214fd,0xd5ee7bbc,0xf68aca7f,0xe856a53e,
	0xb043a9f9,0xae9fc6b8,0x8dfb777b,0x9327183a,0x3dd16ef5,0x230d01b4,
	0x0069b077,0x1eb5df36,0x46a0d3f1,0x587cbcb0,0x7b180d73,0x65c46232,
	0x2fcf0ac8,0x31136589,0x1277d44a,0x0cabbb0b,0x54beb7cc,0x4a62d88d,
	0x6906694e,0x77da060f,0xd92c70c0,0xc7f01f81,0xe494ae42,0xfa48c103,
	0xa25dcdc4,0xbc81a285,0x9fe51346,0x81397c07,0xdcd59199,0xc209fed8,
	0xe16d4f1b,0xffb1205a,0xa7a42c9d,0xb97843dc,0x9a1cf21f,0x84c09d5e,
	0x2a36eb91,0x34ea84d0,0x178e3513,0x09525a52,0x51475695,0x4f9b39d4,
	0x6cff8817,0x7223e756,0xd726532b,0xc9fa3c6a,0xea9e8da9,0xf442e2e8,
	0xac57ee2f,0xb28b816e,0x91ef30ad,0x8f335fec,0x21c52923,0x3f194662,
	0x1c7df7a1,0x02a198e0,0x5ab49427,0x4468fb66,0x670c4aa5,0x79d025e4,
	0x243cc87a,0x3ae0a73b,0x198416f8,0x075879b9,0x5f4d757e,0x41911a3f,
	0x62f5abfc,0x7c29c4bd,0xd2dfb272,0xcc03dd33,0xef676cf0,0xf1bb03b1,
	0xa9ae0f76,0xb7726037,0x9416d1f4,0x8acabeb5
};

const uint32_t Castagnoli_CRC32_TABLE[256] =
{
    /*- CRC32生成多项式采用0x82F63B78 0x1EDC6F41的镜像 */
	0x00000000,0xf26b8303,0xe13b70f7,0x1350f3f4,0xc79a971f,0x35f1141c,
	0x26a1e7e8,0xd4ca64eb,0x8ad958cf,0x78b2dbcc,0x6be22838,0x9989ab3b,
	0x4d43cfd0,0xbf284cd3,0xac78bf27,0x5e133c24,0x105ec76f,0xe235446c,
	0xf165b798,0x030e349b,0xd7c45070,0x25afd373,0x36ff2087,0xc494a384,
	0x9a879fa0,0x68ec1ca3,0x7bbcef57,0x89d76c54,0x5d1d08bf,0xaf768bbc,
	0xbc267848,0x4e4dfb4b,0x20bd8ede,0xd2d60ddd,0xc186fe29,0x33ed7d2a,
	0xe72719c1,0x154c9ac2,0x061c6936,0xf477ea35,0xaa64d611,0x580f5512,
	0x4b5fa6e6,0xb93425e5,0x6dfe410e,0x9f95c20d,0x8cc531f9,0x7eaeb2fa,
	0x30e349b1,0xc288cab2,0xd1d83946,0x23b3ba45,0xf779deae,0x05125dad,
	0x1642ae59,0xe4292d5a,0xba3a117e,0x4851927d,0x5b016189,0xa96ae28a,
	0x7da08661,0x8fcb0562,0x9c9bf696,0x6ef07595,0x417b1dbc,0xb3109ebf,
	0xa0406d4b,0x522bee48,0x86e18aa3,0x748a09a0,0x67dafa54,0x95b17957,
	0xcba24573,0x39c9c670,0x2a993584,0xd8f2b687,0x0c38d26c,0xfe53516f,
	0xed03a29b,0x1f682198,0x5125dad3,0xa34e59d0,0xb01eaa24,0x42752927,
	0x96bf4dcc,0x64d4cecf,0x77843d3b,0x85efbe38,0xdbfc821c,0x2997011f,
	0x3ac7f2eb,0xc8ac71e8,0x1c661503,0xee0d9600,0xfd5d65f4,0x0f36e6f7,
	0x61c69362,0x93ad1061,0x80fde395,0x72966096,0xa65c047d,0x5437877e,
	0x4767748a,0xb50cf789,0xeb1fcbad,0x197448ae,0x0a24bb5a,0xf84f3859,
	0x2c855cb2,0xdeeedfb1,0xcdbe2c45,0x3fd5af46,0x7198540d,0x83f3d70e,
	0x90a324fa,0x62c8a7f9,0xb602c312,0x44694011,0x5739b3e5,0xa55230e6,
	0xfb410cc2,0x092a8fc1,0x1a7a7c35,0xe811ff36,0x3cdb9bdd,0xceb018de,
	0xdde0eb2a,0x2f8b6829,0x82f63b78,0x709db87b,0x63cd4b8f,0x91a6c88c,
	0x456cac67,0xb7072f64,0xa457dc90,0x563c5f93,0x082f63b7,0xfa44e0b4,
	0xe9141340,0x1b7f9043,0xcfb5f4a8,0x3dde77ab,0x2e8e845f,0xdce5075c,
	0x92a8fc17,0x60c37f14,0x73938ce0,0x81f80fe3,0x55326b08,0xa759e80b,
	0xb4091bff,0x466298fc,0x1871a4d8,0xea1a27db,0xf94ad42f,0x0b21572c,
	0xdfeb33c7,0x2d80b0c4,0x3ed04330,0xccbbc033,0xa24bb5a6,0x502036a5,
	0x4370c551,0xb11b4652,0x65d122b9,0x97baa1ba,0x84ea524e,0x7681d14d,
	0x2892ed69,0xdaf96e6a,0xc9a99d9e,0x3bc21e9d,0xef087a76,0x1d63f975,
	0x0e330a81,0xfc588982,0xb21572c9,0x407ef1ca,0x532e023e,0xa145813d,
	0x758fe5d6,0x87e466d5,0x94b49521,0x66df1622,0x38cc2a06,0xcaa7a905,
	0xd9f75af1,0x2b9cd9f2,0xff56bd19,0x0d3d3e1a,0x1e6dcdee,0xec064eed,
	0xc38d26c4,0x31e6a5c7,0x22b65633,0xd0ddd530,0x0417b1db,0xf67c32d8,
	0xe52cc12c,0x1747422f,0x49547e0b,0xbb3ffd08,0xa86f0efc,0x5a048dff,
	0x8ecee914,0x7ca56a17,0x6ff599e3,0x9d9e1ae0,0xd3d3e1ab,0x21b862a8,
	0x32e8915c,0xc083125f,0x144976b4,0xe622f5b7,0xf5720643,0x07198540,
	0x590ab964,0xab613a67,0xb831c993,0x4a5a4a90,0x9e902e7b,0x6cfbad78,
	0x7fab5e8c,0x8dc0dd8f,0xe330a81a,0x115b2b19,0x020bd8ed,0xf0605bee,
	0x24aa3f05,0xd6c1bc06,0xc5914ff2,0x37faccf1,0x69e9f0d5,0x9b8273d6,
	0x88d28022,0x7ab90321,0xae7367ca,0x5c18e4c9,0x4f48173d,0xbd23943e,
	0xf36e6f75,0x0105ec76,0x12551f82,0xe03e9c81,0x34f4f86a,0xc69f7b69,
	0xd5cf889d,0x27a40b9e,0x79b737ba,0x8bdcb4b9,0x988c474d,0x6ae7c44e,
	0xbe2da0a5,0x4c4623a6,0x5f16d052,0xad7d5351

};

/**
 * @brief calculate_CRC32 通用查表法CRC32计算函数
 * @param   aData	待计算CRC的数据指针
 * @param   aSize	数据长度
 * @param   Table_CRC32 CRC32位生成多项式计算表
 * @param   nAccumInit CRC32计算初始值
 * @return  计算出的CRC值
 */
uint32_t calculate_CRC32( const uint8_t * aData, const uint32_t aSize,
				    const uint32_t Table_CRC32[256], const uint32_t  nAccumInit, const uint32_t nAccumXOR)
{
	/*- 变量初始化 */
	 uint32_t i     = 0u;
     uint32_t crc   = 0u;

	 /*- 如果输入数据(aData)指针及多项式表Table_CRC32非空 */
	 if ((aData != NULL)&&(Table_CRC32!=NULL))
	 {
		crc = nAccumInit; /*-< 把初始值赋给crc */
        /*- @alias 计算CRC */
		for (i = 0u; i < aSize; i++)
		{
			crc = Table_CRC32[(crc ^ aData[i]) & 0xFFU] ^ (crc >> 8u);
		}
        /*- CRC异或运算 */
		crc = crc^nAccumXOR;
	 }
	 else
	 {
		 crc = 0xFFFFFFFF; /*-< 计算为0xFFFFFFFF */
	 }

	 /*- 返回计算的CRC值 */
	 return crc;
}

/** @brief  cb_crc32_ieee8023 IEEE 802.3 CRC32算法计算接口函数，默认初值为和异或值为0xFFFFFFFF
 *  @detail 多项式: X32+X26+X23+X22+X16+X12+X11+X10+X8+X7+X5+X4+X2+X1+1，对应数字是0x04C11DB7, 最高位1不显示
 *  @param data 数据地址
 *  @param size 数据长度
 *  @return 计算的CRC32值
 */
uint32_t cb_crc32_ieee8023(const uint8_t * data, uint32_t size)
{
	/*- 变量初始化 */
	uint32_t crc = 0u;

	/*- 计算CRC */
	crc = calculate_CRC32((const uint8_t*)data, size, IEEE8023_CRC32_TABLE, 0xFFFFFFFFu, 0xFFFFFFFFu);

	/*- 返回计算的CRC32值 */
	return crc;
}

/**
 * @brief  cb_crc16_ccitt CCITT CRC16计算接口函数
 * @param  data 数据地址
 * @param  size 数据长度
 * @return 计算出的CRC16值
 */
uint16_t cb_crc16_ccitt(const uint8_t * pdata, uint32_t size)
{
	/*- 变量初始化 */
    uint32_t  i           = 0u;
    uint16_t  crc         = 0x0000u; /*-< CRC计算过程量 */
	uint16_t  index       = 0u; /*-< 查表下标 */
	const uint8_t *data   = pdata;
	const uint16_t *table = CCITT_CRC16_TABLE; /*-< 使用CCITT多项式表 */

	/*- 判断data是否为非空指针 */
	if (NULL != data)
	{
		for (i=0u; i<size; i++)
		{
			index  = ( crc >> 8u ) ^ *data;
			data++;
		    crc = ( crc << 8u ) ^ table[index];
		}
	}
	else
	{
        /*- 置为默认值 */
	    crc= 0xFFFFu;
	}

	/*- 返回计算出的CRC16值 */
	return (crc);
}

uint32_t cb_crc32_Castagnoli(const uint8_t * data, uint32_t size)
{
	/*- 变量初始化 */
    uint32_t crc = 0u;
    crc = calculate_CRC32((const uint8_t*)data, size, Castagnoli_CRC32_TABLE, 0xFFFFFFFFu, 0xFFFFFFFFu);

	/*- 返回计算的CRC值 */
	return (crc);
}
